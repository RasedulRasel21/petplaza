{% unless image_size %}
  {% assign image_size = 'large' %}
{% endunless %}

{% assign grid_image_scale = '2' %}

{% assign on_sale = false %}
{% assign sale_text = 'products.product.sale' | t %}
{% if product.compare_at_price > product.price %}
  {% assign on_sale = true %}
{% endif %}

{% assign sold_out = true %}
{% assign sold_out_text = 'products.product.sold_out' | t %}
{% assign sTT = 'products.product.outOfStock' | t %}
{% if product.available %}
  {% assign sold_out = false %}
  {% assign sTT = 'products.product.inStock' | t %}
{% endif %}

<div class="product-item" data-id="product-{{ product.id }}">
  <div class="item-inner">
    <div class="product-image">
      <a
        class="grid-view-item__link image-ajax"
        title="{{ product.title }}"
        href="{{ product.url | within: collection }}"
      >
        <img
          class="img-responsive s-img main-image"
          src="{{ product.featured_image.src | product_img_url:image_size, crop:'center' }}"
          alt="{{ product.featured_image.alt }}"
        >
        {%- if product.media[1] != nil -%}
          <img
            class="img-responsive s-img second-image"
            src="{{ product.media[1] | product_img_url:image_size, crop:'center'  }}"
            alt="{{ product.featured_image.alt }}"
          >
          {% endif %}
      </a>

      <div class="product-label">
        {% if product.tags contains "new" %}
        <div class="label-product label-new">
          <span class="label">{{ 'general.megamenu_icons.new' | t }}</span>
        </div>
        {% endif %}
        {% if on_sale %}
        <div class="label-product label-sale">
          <!-- <span class="label">{{ 'products.product.on_sale' | t }}</span> -->
          <span class="sale-value">
            -{{ product.selected_or_first_available_variant.compare_at_price | minus: product.selected_or_first_available_variant.price | times: 100.0 | divided_by: product.selected_or_first_available_variant.compare_at_price | money_without_currency | replace: ',', '.' | times: 100 | remove: '.0'}}%</div>
          </span>
        {% endif %}
      </div>

      <div class="product-item-actions">
        {% render 'product-wishlist', product: product %}
        <div class="quickview-button">
          <a
            class="action"
            href="javascript:void(0)"
            data-variants_id="{{ product.variants[0].id }}"
            data-toggle="modal"
            data-target="#myModal"
            data-id="{{ product.handle }}"
            title="{{ 'products.product.quick_view' | t }}"
          >
          <i class="la la-eye"></i>
            <span>{{ 'products.product.quick_view' | t }}</span>
          </a>
        </div>
      </div>
    </div>

    <div class="product-info">
      {% if settings['show-vendor'] %}
        <div class="title-vendor">{{ product.vendor | link_to_vendor }}</div>
      {% endif %}

      {% if settings['show-title'] %}
        <div class="product-name">
          <strong>
            <a href="{{ product.url }}" title="{{ product.title }}">{{ product.title | strip_html | truncate: settings.limit_title }}</a>
          </strong>
        </div>
      {% endif %}

      {% if settings['show-review'] %}
        <div class="custom-reviews">
          <span class="shopify-product-reviews-badge" data-id="{{ product.id }}"></span>
        </div>
      {% endif %}
      {% if product.metafields.product_fields.short_description.value !="" %}
        <div class="short-description">
          {{ product.metafields.product_fields.short_description.value }}
        </div>
      {% endif %}
        
      {% if settings['show-price'] %}
        {% render 'price-product', product: product %}
      {% endif %}

      {% if sold_out %}
        <div class="btn-button add-to-cart btn-sold-out action">
          <a type="submit" value="Submit" data-toggle="tooltip" title="{{ 'products.product.sold_out' | t }}">
            <span class="">{{ 'products.product.sold_out' | t }}</span>
          </a>
      </div>
      {% elsif product.variants.size > 1 %}
        <div class="btn-button add-to-cart add-select">
          <a href="{{ product.url | within: collection }}" class="btn_df grl" title="{{ 'products.product.select_options' | t }}">
              <i class="la la-cart-plus"></i>
              <span>{{ 'products.product.select_options' | t }}</span>
          </a>
        </div>
      {% else %}
        <div class="btn-button add-to-cart action  {% if sold_out %}sold-out{% endif %}">
          <form
            action="/cart/add"
            method="post"
            class="variants"
            data-id="AddToCartForm-{{ product.id }}"
            enctype="multipart/form-data"
          >
            <input type="hidden" name="id" value="{{ product.variants[0].id }}">
            <a
              class="action-to-cart"
              href="javascript:void(0)"
              title="{{ 'products.product.add_to_cart' | t }}"
              >
              <i class="la la-cart-plus"></i>
              <span>{{ 'products.product.add_to_cart' | t }}</span></a
            >
          </form>
        </div>
      {% endif %}

     
    </div>
  </div>
</div>
